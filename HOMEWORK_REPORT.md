# ОТЧЕТ ПО ДОМАШНЕМУ ЗАДАНИЮ: HR-АССИСТЕНТ

## ЭТАП 1: ОПИСАНИЕ ПРОЕКТА

### Роль ассистента: HR-помощник для сотрудников компании

**Основной пользователь:**
Сотрудники компании (новички и действующие работники), которым нужна быстрая информация по кадровым вопросам, корпоративным правилам и административным процедурам.

**Типичные вопросы пользователей:**
- "Как оформить отпуск?"
- "Какой у нас дресс-код?"
- "Сколько дней больничного мне положено?"
- "Можно ли работать удаленно?"
- "Когда выплачиваются отпускные?"
- "Какие праздничные дни в этом году?"
- "Как получить компенсацию за фитнес?"

**База знаний (RAG):**
В проекте используются 3 текстовых файла, размещенных в папке `data/documents/`:
1. **корпоративные_правила.txt** - полная информация о дресс-коде, корпоративной этике, использовании офисных ресурсов, безопасности, мероприятиях, обучении и социальных льготах
2. **отпуска_и_больничные.txt** - детальное положение об оформлении отпусков, расчете отпускных, больничных листах и всех связанных процедурах
3. **график_работы.txt** - информация о рабочем времени, гибком графике, удаленной работе, переработках и праздничных днях

---

## ЭТАП 2: ПОДГОТОВКА БАЗЫ ЗНАНИЙ RAG

### Созданные файлы:
✅ `data/documents/корпоративные_правила.txt` (10 разделов, ~200 строк)
✅ `data/documents/отпуска_и_больничные.txt` (10 разделов, ~120 строк)
✅ `data/documents/график_работы.txt` (8 разделов, ~80 строк)

### Инструкции для индексации:
1. Перезапустите бота: `python main.py`
2. В Telegram отправьте команду `/index` для индексации документов
3. Проверьте статус командой `/stats`

**Ожидаемый результат:**
Система должна проиндексировать 3 документа и создать векторную базу данных FAISS для быстрого поиска релевантной информации.

---

## ЭТАП 3: ТЕСТИРОВАНИЕ МОДАЛЬНОСТЕЙ

### Тест 1: Текстовый режим + RAG (обязательно)
**Команды:**
```
/mode rag
Как оформить отпуск?
```

**Ожидаемый результат:**
Бот должен ответить с информацией из файла `отпуска_и_больничные.txt`, указав источник документа и релевантные разделы о порядке оформления отпуска (согласование с руководителем, подача заявления через портал, сроки).

---

### Тест 2: Обычный текстовый режим
**Команды:**
```
/mode text
Расскажи анекдот про программистов
```

**Ожидаемый результат:**
Бот отвечает в обычном режиме без использования базы знаний, генерируя ответ через OpenAI GPT.

---

### Тест 3: Голосовой режим
**Команды:**
```
/mode voice
[Отправить голосовое сообщение: "Какой у нас дресс-код?"]
```

**Ожидаемый результат:**
Бот распознает голосовое сообщение через Whisper API, обрабатывает вопрос и отвечает текстом или голосом (в зависимости от настроек) с информацией о дресс-коде из базы знаний.

---

### Тест 4: Анализ изображений
**Команды:**
```
[Отправить скриншот документа или фото]
Что на этом изображении?
```

**Ожидаемый результат:**
Бот анализирует изображение через GPT-4 Vision API и описывает содержимое.

---

### Тест 5: Генерация изображений
**Команды:**
```
/image офисное пространство с современным дизайном
```

**Ожидаемый результат:**
Бот генерирует изображение через DALL-E API и отправляет результат пользователю.

---

## ЭТАП 4: АРХИТЕКТУРА ПРОЕКТА

### Схема пайплайна:
```
Пользователь (Telegram)
    ↓
handlers/ [text.py / voice.py / image.py / document_upload.py]
    ↓
services/router.py (маршрутизация запросов)
    ↓
    ├→ OpenAI GPT-4 (текстовые ответы)
    ├→ OpenAI Whisper (распознавание речи)
    ├→ OpenAI TTS (синтез речи)
    ├→ OpenAI DALL-E (генерация изображений)
    ├→ OpenAI Vision (анализ изображений)
    └→ FAISS Vector Store (RAG - поиск в базе знаний)
    ↓
Ответ пользователю в Telegram
```

### Описание структуры проекта:

**handlers/** - обработчики входящих сообщений от пользователей
- `text.py` - обработка текстовых сообщений
- `voice.py` - обработка голосовых сообщений (STT через Whisper)
- `image.py` - обработка изображений (анализ через Vision API)
- `document_upload.py` - загрузка документов для индексации в RAG
- `start.py` - команды запуска и меню бота

**services/** - бизнес-логика и интеграции с внешними API
- Маршрутизация запросов к OpenAI
- Управление контекстом диалога
- Интеграция с различными моделями (GPT, Whisper, DALL-E, Vision)

**rag/** - система Retrieval-Augmented Generation
- `faiss_store.py` - векторное хранилище на базе FAISS
- `index.py` - индексация документов и создание эмбеддингов
- Поиск релевантной информации в базе знаний

**utils/** - вспомогательные утилиты
- Логирование
- Обработка ошибок
- Форматирование ответов

**data/** - хранилище данных
- `documents/` - текстовые файлы для базы знаний
- `generated_images/` - сгенерированные изображения

### Как работает маршрутизация:
Когда пользователь отправляет сообщение, соответствующий handler определяет тип запроса (текст/голос/изображение) и передает его в services/router.py. Роутер анализирует текущий режим работы бота (/mode rag, /mode text, /mode voice) и направляет запрос либо в RAG-систему для поиска в базе знаний, либо напрямую в OpenAI API для генерации ответа. В режиме RAG система сначала ищет релевантные фрагменты в FAISS, затем формирует контекст и отправляет в GPT для генерации финального ответа с указанием источников.

---

## ИНСТРУКЦИИ ДЛЯ ЗАПУСКА

1. Установите зависимости: `pip install -r requirements.txt`
2. Настройте `.env` файл с токенами Telegram и OpenAI
3. Запустите бота: `python main.py`
4. В Telegram:
   - Отправьте `/start` для начала работы
   - Отправьте `/index` для индексации документов
   - Отправьте `/stats` для проверки статуса
   - Используйте `/mode rag` для включения режима работы с базой знаний

---

## КОНТРОЛЬНЫЙ СПИСОК ДЛЯ СДАЧИ

- [x] Создано 3 текстовых файла для базы знаний
- [x] Написано описание проекта (пользователь, вопросы, данные)
- [ ] Выполнена индексация документов (скриншот `/stats`)
- [ ] Протестирован режим RAG (скриншот вопрос-ответ с источником)
- [ ] Протестирован обычный текстовый режим (скриншот)
- [ ] Протестирован голосовой режим (скриншот)
- [ ] Протестирован анализ изображений (скриншот)
- [x] Описана архитектура проекта
- [x] Создан итоговый отчет

---

**Дата создания:** 17 декабря 2025
**Сценарий:** HR-помощник для сотрудников компании
**Технологии:** Python, Telegram Bot API, OpenAI API (GPT-4, Whisper, DALL-E, Vision), FAISS
